#!/usr/bin/env bash

#===================================
# Generated by bashtools
#===================================

set -o nounset
set -o errexit

path_bin=/usr/local/bin/
path_data=/usr/local/share/compare
path_lib=/usr/local/lib/compare
name=compare
version=1.0.0
auteur=jtutzo

if [[ ${1:-} = "-h" || ${1:-} == "--help" ]]
then
	echo "Name : ${name}"
	echo "Version : ${version}"
	echo "Auteur : ${auteur}"
	cat ${path_data}/${name}.help

elif [[ ${1:-} = "-v" || ${1:-} == "--version" ]]
then
 	echo "${name}@${version}"

elif [[ ${1:-} = "-d" || ${1:-} == "--debug" ]]
then
	echo "path_bin : ${path_bin}"
	echo "path_data : ${path_data}"
	echo "path_lib : ${path_lib}"
	echo "name : ${name}"
	echo "version : ${version}"
	echo "auteur : ${auteur}"

else
	echo "Start sort"
	sort ${1} -o ${1}.tmp
	sort ${2} -o ${2}.tmp
	echo "End sort"
	liste_doublon=(`comm -1 -2 ${1}.tmp ${2}.tmp`)
	rm -rf ${1}.tmp ${2}.tmp
	echo "valeur;line to `echo ${1} | awk -F/ '{print $NF}'` ;line to `echo ${2} | awk -F/ '{print $NF}'`"
	for doublon in ${liste_doublon[@]}
	do
		value=`echo "${doublon}" | awk -F "," '{print $1}'`
		echo -n "${value};"
		result1=(`grep -n "${doublon}" ${1} | awk -F: '{print $1}'`)
		result2=(`grep -n "${doublon}" ${2} | awk -F: '{print $1}'`)
		echo -n "${result1[@]};"
		echo "${result2[@]}"
	done
	echo "End command"
fi
